<!DOCTYPE html>

<html>
    <head>
        <title>#{get 'title' /}</title>
        <meta charset="${_response_encoding}">
        <link rel="stylesheet" media="screen" href="@{'/public/stylesheets/main.css'}">
        <link rel="stylesheet" media="screen" href="@{'/public/stylesheets/ui-lightness/jquery-ui-1.8.16.css'}">
        #{get 'moreStyles' /}
        <link rel="shortcut icon" type="image/png" href="@{'/public/images/favicon.png'}">
        <script src="@{'/public/javascripts/jquery-1.7.1.min.js'}" type="text/javascript" charset="${_response_encoding}"></script>
		<script src="@{'/public/javascripts/jquery-ui-1.8.16.min.js'}" type="text/javascript" charset="${_response_encoding}"></script>
		#{script "ontologyLearner.js" /}
		#{script "ontologyLearner.Util.js" /}
		#{script "ontologyLearner.UrlStore.js" /}
		#{script "widgets.spinner.js" /}
        #{get 'moreScripts' /}
        
        <script type="text/javascript">
        	(function(window, document, UrlStore) {
        		function encode(uri) {
        			return window.encodeURIComponent(uri);
        		}
        		
        		function addUrlParams(url, params) {
        			if (!params || params=={}) {
        				return url;
        			}
        			
        			var paramString = "";
        			for (var param in params) {
        				if (paramString) {
        					paramString += "&";
        				}
        				
        				paramString += encode(param) + "=" + encode(params[param]);
        			}
        			
        			return url + "?" + paramString;
        		}

				function addDocumentParams(url, featureType, bypassCache) {
					featureType = encode(featureType);
					bypassCache = encode(bypassCache);
					
					if (!featureType) {
						featureType = "smart_nouns";
					}
					
					return addUrlParams(url, {
						featureType: featureType.toUpperCase(),
						bypassCache: bypassCache.toString()
					});
				}
				        		
				UrlStore.getDocumentList = function() {
					return "@{Documents.list()}";
				};
				UrlStore.getNextBestDocument = function(featureType, bypassCache) {
					return addDocumentParams("@{Documents.nextBest()}", featureType, bypassCache)
				};
				UrlStore.getDocument = function(uuid, featureType, bypassCache) {
					uuid = encode(uuid);
					return addDocumentParams("@{Documents.single(':uuid:')}".replace(":uuid:", uuid), featureType, bypassCache)
				};
				UrlStore.seeDocument = function(uuid) {
					uuid = encode(uuid);
					return "@{Documents.see(':uuid:')}".replace(":uuid:", uuid);
				};
				
				UrlStore.getAspectList = function() { return "@{Aspects.list()}"; };
				UrlStore.getAspect = function(aspect) {
					aspect = encode(aspect);
					return "@{Aspects.single(':aspect:')}".replace(":aspect:", aspect);
				};
				UrlStore.postAspect = function(aspect) {
					aspect = encode(aspect);
					return "@{Aspects.postAspect(':aspect:')}".replace(":aspect:", aspect);
				};
				UrlStore.postKeyword = function(aspect, keyword) {
					aspect = encode(aspect);
					keyword = encode(keyword);
					return "@{Aspects.postKeyword(':aspect:', ':keyword:')}".replace(":aspect:", aspect).replace(":keyword:", keyword);
				};
				UrlStore.deleteAspect = function(aspect) {
					aspect = encode(aspect);
					return "@{Aspects.deleteAspect(':aspect:')}".replace(":aspect:", aspect);
				};
				UrlStore.deleteKeyword = function(aspect, keyword) {
					aspect = encode(aspect);
					keyword = encode(keyword);
					return "@{Aspects.deleteKeyword(':aspect:', ':keyword:')}".replace(":aspect:", aspect).replace(":keyword:", keyword);
				};
			})(window, window.document, window.ontologyLearner.UrlStore);
        </script>
    </head>
    <body>
        #{doLayout /}
    </body>
</html>
